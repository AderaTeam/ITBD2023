# Обработка обращений граждан

Обученные модели: https://drive.google.com/drive/folders/16KhtZbdi2Z1DuxIwXHhGSUTxMcTd2dkv?usp=sharing

## Инициализация среды
Для загрузки библиотек нужно выполнить команду:

```pip install -r .\requirments.txt -f https://download.pytorch.org/whl/torch_stable.html```

## Работа алгоритма

1) На вход подаётся строка (текст обращения)
2) Из неё выделяются именнованные сущности
3) Удаляется именнованная сущность МЕСТО(PLACE), если не является часть именнованной сущности ПРОБЛЕМА(PROBLEM)
4) Из строки удаляются паттерны, имеющие малую значимость
5) Строка преобразуется в последовательность векторов с помощью SBERT
6) Полученная секвенция подаётся на вход трём классификаторам для выделения Группы тем, Темы и Исполнителя



## Анализ входных данных
**Происходит в файле prewatch_data.ipynb**
**И ещё немного в файлах ModelOnPreClean.ipynb, ModelOnExe.ipynb, train_model_on_vec_seq.ipynb**

Были выделенны следующие преценденты:
- Все классы имеют одинаковое вероятностное пространство  с показательным законом распределения;
- 10 классов для выборки группы тем удовлетворяют критерию стьюдента с уверенностью в 95% (файл prewatch_data.ipynb);
- по ковариационной матрице были определенны наиболеесхожие обращения и их классы (файлы ModelOnPreClean.ipynb и ModelOnExe.ipynb);
- оределённа размерность эмбендингов (файл train_model_on_vec_seq.ipynb)
## Модель для классификации груп тем
**Создаётся в файле ModelOnPreClean.ipynb**

Представляет из себя рекурентную модель + свёрточный выходной слой.

Входной слой - эмбединги созданные с помощью SBert с размерами для вектора слова 384 и длиной последовательности 128

На выходе имеем OneHot вектор размерности 10 (топ 10 наиболее популярных классов, удовлетворяющих критерию Стьюденда) 

## Модель для классификации исполнителей
**Создаётся в файле ModelOnExe.ipynb**

Представляет из себя рекурентную модель + свёрточный выходной слой.

Входной слой - эмбединги созданные с помощью SBert с размерами для вектора слова 384 и длиной последовательности 128

На выходе имеем OneHot вектор размерности 10 (соответствует числу классов в изначальном датасете)

## Модели для выделения именованных сущностей
**Создаются в файле ner.ipynb**

- ner_prob - находет сущность ПРОБЛЕММА(PROBLEM) в тексте;
- ner_place - находет сущность МЕСТО(PLACE) в тексте;

Решение разделить их на два было вызванно тем, что иногда место является проблеммой
